 <style>
    .accordion-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .accordion-item.active .accordion-content {
        max-height: 1000px;
    }

    .accordion-item.active .chevron-icon {
        transform: rotate(180deg);
    }
</style>

<div #scrollContainer class="absolute inset-0 flex flex-col min-w-0 overflow-y-auto" cdkScrollable>
    <ng-container *transloco="let t">
        <div (click)="closeDropdown()" class="min-h-full flex items-center justify-center">
            <div class="flex min-w-0 flex-auto flex-col mt-2 items-center justify-center h-full w-full">
                <div class="relative flex justify-center items-center p-3 sm:p-5 md:p-8 w-full h-full">
                    <fuse-card class="flex flex-col max-w-xl w-full md:w-[600px] h-[70vh] sm:h-[80vh] md:h-[70vh]"
                        [flippable]="true" #heroCard>

                        <ng-container fuseCardFront>
                            <div class="relative w-full h-full rounded-3xl overflow-hidden shadow-lg
                    flex items-center justify-center text-white bg-cover bg-center"
                                style="backface-visibility: hidden; -webkit-backface-visibility: hidden;"
                                [ngStyle]="{ 'background-image': currentImage ? 'url(' + currentImage + ')' : 'none' }"
                                [style.pointerEvents]="heroCard?.face === 'back' ? 'none' : 'auto'"
                                [style.visibility]="heroCard?.face === 'back' ? 'hidden' : 'visible'"
                                [style.zIndex]="heroCard?.face === 'front' ? 20 : 0">

                                <div *ngIf="overlayImage"
                                    class="absolute inset-0 bg-cover bg-center transition-opacity duration-500 pointer-events-none"
                                    [ngStyle]="{ 'background-image': 'url(' + overlayImage + ')' }"
                                    [class.opacity-0]="!isTransitioning" [class.opacity-100]="isTransitioning"></div>

                                <div class="absolute inset-0 bg-black/40 z-0 pointer-events-none"></div>

                                <div class="absolute top-10 z-10 flex flex-col items-center text-center px-6 space-y-2">
                                    <span class="text-3xl font-bold">{{ t('titulo-destinos') }}</span>
                                </div>


                                <div class="absolute bottom-5 transform flex flex-col gap-4 z-20"
                                    (click)="closeDropdown()">
                                    <h1 class="text-2xl font-bold text-white tracking-tight"></h1>

                                    <div class="relative w-full mx-auto" (click)="$event.stopPropagation()">
                                        <button type="button" (click)="toggleDropdown($event)" class="w-full bg-green-700 hover:bg-emerald-800 text-white px-8 py-5 rounded-full
             flex items-center justify-between shadow-2xl
             transition-all duration-300 active:scale-[0.98]">
                                            <span class="flex items-center gap-3 text-lg font-semibold">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                                    stroke-width="1.5" stroke="currentColor" class="size-6">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503 3.498
               4.875-2.437c.381-.19.622-.58.622-1.006V4.82
               c0-.836-.88-1.38-1.628-1.006l-3.869 1.934
               c-.317.159-.69.159-1.006 0L9.503 3.252
               a1.125 1.125 0 0 0-1.006 0L3.622 5.689
               C3.24 5.88 3 6.27 3 6.695V19.18
               c0 .836.88 1.38 1.628 1.006l3.869-1.934
               c.317-.159.69-.159 1.006 0l4.994 2.497
               c.317.158.69.158 1.006 0Z" />
                                                </svg>

                                                {{ t('selecciona-proxima-aventura') }}
                                            </span>
                                        </button>

                                        <div class="absolute bottom-full left-0 right-0 mb-4
             bg-white dark:bg-gray-800 rounded-[2rem]
             overflow-hidden dropdown-shadow
             transition-all duration-300 z-20
             border border-white/20" [ngClass]="dropdownOpen
        ? 'opacity-100 translate-y-0 pointer-events-auto'
        : 'opacity-0 translate-y-4 pointer-events-none'">
                                            <div class="p-2">

                                                <button type="button" class="w-full group/item flex items-center gap-4 p-5
                 rounded-[1.5rem] transition-all duration-200
                 hover:bg-gray-100 dark:hover:bg-gray-700"
                                                    (click)="cargarDestinos(1); showOverlay(); closeDropdown();">
                                                    <div class="w-12 h-12 flex items-center justify-center
                   rounded-full overflow-hidden">
                                                        <img class="w-full h-full object-cover"
                                                            src="images/flags/MX.svg" alt="MÃ©xico" />
                                                    </div>

                                                    <div class="text-left">
                                                        <span
                                                            class="block text-lg font-bold text-gray-800 dark:text-gray-100">
                                                            {{ t('destinos-nacionales') }}
                                                        </span>
                                                        <span class="text-sm text-gray-500 dark:text-gray-400">
                                                            {{ t('descubre-la-magia-de-mexico') }}
                                                        </span>
                                                    </div>
                                                </button>
                                                <button type="button" class="w-full group/item flex items-center gap-4 p-5
                 rounded-[1.5rem] transition-all duration-200
                 hover:bg-gray-100 dark:hover:bg-gray-700"
                                                    (click)="cargarDestinos(2); showOverlay(); closeDropdown();">
                                                    <div class="w-12 h-12 flex items-center justify-center
                   rounded-full overflow-hidden">
                                                        <img class="w-full h-full object-cover"
                                                            src="images/earth-icon.svg" alt="Internacional" />
                                                    </div>

                                                    <div class="text-left">
                                                        <span
                                                            class="block text-lg font-bold text-gray-800 dark:text-gray-100">
                                                            {{ t('destinos-internacionales') }}
                                                        </span>
                                                        <span class="text-sm text-gray-500 dark:text-gray-400">
                                                            {{ t('explora-fronteras-lejanas') }}
                                                        </span>
                                                    </div>
                                                </button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container fuseCardBack>
                            <div class="relative w-full h-full rounded-3xl shadow-lg
                bg-[#0B0B2B] flex flex-col px-8 pt-10 pb-6 text-white z-[1000]">
                            </div>
                        </ng-container>

                    </fuse-card>
                    @if(overlayAnimatedOnce){

                    <div class="absolute max-w-xl w-full md:w-[600px] h-[70vh] sm:h-[80vh] md:h-[70vh] px-1" [ngClass]="[
        heroCard?.face === 'back'
          ? 'opacity-100 z-[50] pointer-events-auto'
          : 'opacity-0 z-[-1] pointer-events-none',
    
        overlayAnimatedOnce
          ? 'transition-opacity duration-1000'
          : ''
      ]">

                        <div class="relative w-full h-full rounded-3xl shadow-lg
                  bg-[#0B0B2B] flex flex-col px-8 pt-10 pb-6 text-white">

                            <button type="button" mat-icon-button
                                class="absolute top-4 right-4 z-[9999] bg-white/10 hover:bg-white/20 rounded-full transition"
                                (click)="hideOverlay();">
                                <mat-icon class="text-white">arrow_back</mat-icon>
                            </button>

                            <div class="w-full h-full flex flex-col text-center min-h-0">
                                <h2 class="text-3xl font-bold mb-4 tracking-tight">
                                    {{ tipoDestino === 1 ? t('selecciona-destino') : t('explora-continente') }}
                                </h2>

                                <p class="text-md text-gray-300 mb-6">
                                    {{ tipoDestino === 1 ? t('texto-nacionales') : t('texto-internacionales') }}
                                </p>

                                <div class="flex flex-col gap-4 flex-1 min-h-0 overflow-y-auto px-1 custom-scrollbar">
                                    <button *ngFor="let item of (tipoDestino === 1 ? destinos : this.agrupadosDestinos)"
                                        class="w-full py-3 bg-white/10 hover:bg-white/20 rounded-xl shadow-md
                               text-lg font-semibold tracking-wide backdrop-blur-sm transition
                               flex items-center justify-between px-5 group z-[9999]" (click)="cargaInfo(item)">
                                        <span class="group-hover:not-italic">
                                            {{ tipoDestino === 1 ? item.nombre : item.nombrePadre }}
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    }

                </div>
            </div>
        </div>

        <app-footer />
    </ng-container>
</div> 